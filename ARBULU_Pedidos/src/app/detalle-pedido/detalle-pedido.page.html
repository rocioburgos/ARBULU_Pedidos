<ion-header>
  <ion-toolbar>
    <ion-back-button slot="start"></ion-back-button>
    <ion-title>Detalle pedido- Mesa {{ pedido.numero_mesa }} </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>

  <!--EMPLEADO DE LA COCINA / BARRA-->
  <div *ngIf="esEmpleado">
    <div *ngFor="let item of pedido.productos">
      <ion-card *ngIf="item.sector == sectorUserActual" style=" 
      text-align:center; 
      padding:8px;
    ">

        <ion-card-header>
          <ion-card-title> {{item.nombre}}</ion-card-title>
        </ion-card-header>

        <ion-card-content>
          <ion-label>Cantidad pedida: {{item.cantidad}} </ion-label> <br>
          <ion-label>Estado: {{item.estadoProductoPedido}} </ion-label>

          <ion-button size="small" color="warning"
            *ngIf="(pedido.estado=='CONFIRMADO' || pedido.estado=='EN_ELABORACION') && item.estadoProductoPedido =='PENDIENTE'"
            (click)="cambiarEstado(item, 'EN_ELABORACION')">Iniciar preparacion</ion-button>
          <ion-button size="small" color="success" *ngIf="item.estadoProductoPedido =='EN_ELABORACION'"
            (click)="cambiarEstado(item,'TERMINADO' )">Finalizar preparacion</ion-button>

        </ion-card-content>

      </ion-card>
    </div>
  </div>


  <!---Detalle para el usuario-->
  <div *ngIf="esCliente">
    <div *ngIf="pedido.estado != 'CUENTA' && pedido.estado != 'PAGADO'  && pedido.estado != 'TERMINADO'">
      <ion-card>
        <ion-card-header>
          <ion-card-title>Detalle de su pedido</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <ion-label>Estado: {{pedido.estado }}</ion-label><br>
          <ion-label>TotalðŸ’µ ${{pedido.total}} </ion-label> <br>
          <ion-label>Tiempo estimado ðŸ•—{{pedido.tiempo_elaboracion}} </ion-label> <br>
          <ion-button *ngIf="pedido.estado=='ENTREGADO'" color='success' (click)="confirmarRecepcion(pedido.doc_id)">
            Confirmar recepcion</ion-button>
          <ion-button *ngIf="pedido.estado=='RECIBIDO'" color='success' (click)="pedirCuenta(pedido.doc_id)">Pedir
            cuenta</ion-button>
        </ion-card-content>
      </ion-card>
      <h1 style="color: #fd0000">Productos</h1>
      <div *ngFor="let item of pedido.productos">
        <ion-card style=" 
      text-align:center; 
      padding:8px;
    ">
          <ion-card-header>
            <ion-card-title> {{item.nombre}}</ion-card-title>
          </ion-card-header>
          <ion-card-content>
            <ion-label>{{item.nombre}}</ion-label><br>
            <ion-label>Cantidad pedida: {{item.cantidad}} </ion-label> <br>
          </ion-card-content>
        </ion-card>
      </div>
    </div>

    <!--DETALLE DE LA CUENTA-->
    <div *ngIf="pedido.estado == 'CUENTA' ">
      <ion-list>
        <ion-item *ngFor="let item of pedido.productos; let index=index">
          <ion-avatar>
            <img [src]="item.img_src">
          </ion-avatar>
          <ion-label>
            <h1>{{item.nombre}}</h1>
            <ion-row>

              <h2 style="margin-left:1em">$ {{item.precio}} X {{item.cantidad}}</h2>
            </ion-row>
          </ion-label>
          <strong>$ {{item.precio * item.cantidad}} </strong>

        </ion-item>
        <ion-label>Sub total ${{pedido.total}}</ion-label>
      </ion-list>
      <!--SOLO SI JUGO-->
      <h1>Descuento por juegos</h1>
      <ion-item>
        <ion-avatar>
          <img src="./../../assets/juegos/juegos-olimpicos.png">
        </ion-avatar>
        <ion-label>
          <h1>Tateti</h1>
          <ion-row>
            <h2 style="margin-left:1em">Resultado: Â¡GanÃ³ un 5% de descuento!</h2>
          </ion-row>
        </ion-label>
      </ion-item> 
      <ion-item>
        <ion-avatar>
          <img src="./../../assets/juegos/juegos-olimpicos.png">
        </ion-avatar>
        <ion-label>
          <h1>Piedra papel tijera</h1>
          <ion-row>
            <h2 style="margin-left:1em">Resultado: Â¡GanÃ³ un 10% de descuento!</h2>
          </ion-row>
        </ion-label>
      </ion-item> 
      <ion-item>
        <ion-avatar>
          <img src="./../../assets/juegos/juegos-olimpicos.png">
        </ion-avatar>
        <ion-label>
          <h1>Menor mayor</h1>
          <ion-row>
            <h2 style="margin-left:1em">Resultado: Â¡GanÃ³ un 15% de descuento!</h2>
          </ion-row>
        </ion-label>
      </ion-item> 

      <h1>Propina</h1>
      <ion-button>Escanear QR de propina</ion-button>
    </div>  
  </div>

  <!--DETALLE PARA EL MOZO-->
  <div *ngIf="esMetre">

    <ion-card>
      <ion-card-header>
        <ion-card-title>Detalle del pedido</ion-card-title>
      </ion-card-header>

      <ion-card-content>
        <ion-label>Estado: {{pedido.estado }}</ion-label><br>
        <ion-label>TotalðŸ’µ ${{pedido.total}} </ion-label> <br>
        <ion-label>Tiempo estimado ðŸ•—{{pedido.tiempo_elaboracion}} </ion-label> <br>
      </ion-card-content>
    </ion-card>
    <h1 style="color: #fd0000">Productos</h1>
    <div *ngFor="let item of pedido.productos">
      <ion-card style=" 
      text-align:center; 
      padding:8px;
    ">

        <ion-card-header>
          <ion-card-title> {{item.nombre}}</ion-card-title>
        </ion-card-header>

        <ion-card-content>
          <ion-label>{{item.nombre}}</ion-label><br>
          <ion-label>Cantidad pedida: {{item.cantidad}} </ion-label> <br>
          <ion-label>Cantidad pedida: {{item.estadoProductoPedido}} </ion-label> <br>
        </ion-card-content>

      </ion-card>
    </div>
  </div>
</ion-content>
<ion-footer collapse="fade" *ngIf="pedido.estado == 'CUENTA' ">
 
      <ion-label style="text-align: right;">Descuentos $500</ion-label> <br>
      <ion-label style="text-align: right;">Propina $100</ion-label> <br>
      <ion-label style="text-align: right;">TotalðŸ’µ ${{pedido.total}}</ion-label>
 
  <ion-button *ngIf="pedido.estado=='CUENTA'" [disabled]="pedido.estado!='CUENTA'" color='success'
    (click)="pagarPedido(pedido.doc_id)" expand="full" shape="round" color="success">
    PAGAR
  </ion-button>
</ion-footer>